getApprovedAgreement = select top 1 * from BillingCentral.Agreement A  left join BillingCentral.Agreement A1 on A.AgreementKey = A1.ParentAgreementKey join BillingCentral.AgreementChangeLog ACL on A.AgreementKey = ACL.AgreementKey  join ( Select AgreementKey AgreementKey, Max(AgreementChangeLogKey) MaxCLKey from BillingCentral.AgreementChangeLog group by AgreementKey ) MC on ACL.AgreementChangeLogKey = MC.MaxCLKey where A.StatusKey<> 931 and ACL.StatusKey = 4622 and A1.AgreementKey is null
getTradeName =  select TradeName from Billingcentral.AgreementTradeName where isActive = 1 and entityTypekey = 4414 and agreementkey =